var parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"HAs+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,n,t,o,r=[128512,128516,127818,127812,127871,127843,127856,127829,127828,127839,128704,128142,128506,9200,128377,128218,128049,128042,128057,128036,128512,128515,128516,128513,128518,128517,129315,128514,128578,128579,128521,128522,128519,129312,128526,129299,129488,127808,127958,127773,128511,9774],c=Math.floor(41*Math.random())+0,a=0,d=null,l=null,i=[],s="Broadcast",u="Private Message",m=function(e){d||(c=Math.floor(41*Math.random())+0,h.server=t.server,t.mess.getUUID(t.handle+String.fromCodePoint(r[c])).then(function(e){if("string"==typeof e)console.error(e);else{var n=btoa(e.comm.id);t.mess.webSocket({handle:e.comm.handle,id:n}),document.querySelector(".handle").innerHTML=d,document.querySelector(".dodex-comm").classList.toggle("pop-show")}}))},p=function(e){h.socket.close(1e3),document.querySelector(".handle").innerHTML="",document.querySelector(".chat-box").innerHTML="",a=0,d=null,l=null,i=[];var n=document.querySelector("#dodexComm");n.querySelector('a[name="private"]').innerHTML=u,n.classList.toggle("pop-show");var t=document.body,o=document.documentElement;t.scrollTop=0,o.scrollTop=0},h={popup:function(r,c,a){n=r,o=a,t=c,void 0===e&&((e=L(t)).onclick=m),S("comm").then(function(n){"string"==typeof n?(E(),document.querySelector("#commHandle").classList.toggle("pop-show")):e.click()})},socket:null,server:"localhost:3087",getUUID:function(e){return C(e)},webSocket:function(e){if(!(e&&e.handle&&e.id))throw new Error("Must supply 'handle' and 'id' for WebSocket");return d=e.handle,l=e.id,this.socket=new WebSocket("ws://"+this.server+"/dodex?handle="+d+"&id="+encodeURIComponent(e.id)),this.socket.onerror=function(e){console.error(e)},this.socket.onopen=function(){document.querySelector(".input-send").onclick=v},this.socket.onmessage=function(e){var n=new Date,t=T(n.getHours()),o=T(n.getMinutes()),r=document.querySelector(".chat-box"),c=f(e.data);r.innerHTML+="".concat(t,":").concat(o," ").concat(c,"<br>"),(r.scrollTop>a||0===a)&&(a=r.scrollTop,r.scrollTop=r.scrollHeight)},this.socket.onclose=function(e){d=null,1e3!==e.code&&console.log("Closed",e.code)},this.socket}};function f(e){var n=e.split("connected:");return n.length<2?e:(M(JSON.parse(n[1])),"connected")}function v(){var e=document.querySelector("#dodexComm").querySelector(".user-msg"),n=e.innerHTML;if(n.length>1){var t=g(n);h.socket.send(t),e.innerHTML=""}}function g(e){return document.querySelector("#dodexComm").querySelector('a[name="private"]').innerHTML===s?e+";users!!"+JSON.stringify(i):e}window.doDexMess=h;var y=h;function S(e){return new Promise(function(e,n){var t=indexedDB.open("dodex-comm");t.onupgradeneeded=function(){t.result.createObjectStore("comm",{keyPath:"idx",autoIncrement:!1})},t.onsuccess=function(n){x("comm",n.target.result).then(function(t){n.target.result.close(),e(t)})},t.onerror=function(e){console.log(e)}})}function C(e){return new Promise(function(n,t){var o,r,c,a=indexedDB.open("dodex-comm");a.onupgradeneeded=function(){o=a.result,c=o.createObjectStore("comm",{keyPath:"idx",autoIncrement:!1})},a.onsuccess=function(t){x("comm",o=t.target.result).then(function(t){if("string"!=typeof t)return o.close(),void n(t);r=o.transaction("comm","readwrite"),c=r.objectStore("comm");var a=B(),d={};d.comm={handle:e,id:a},d.idx="comm",c.put(d).onsuccess=function(e){x("comm",o).then(function(e){o.close(),n(e)})}})},a.onerror=function(e){console.error("Error",e.target)}})}function x(e,n){return new Promise(function(t,o){0===n.objectStoreNames.length&&t("Store ".concat(e," not found"));var r=n.transaction(["comm"],"readonly").objectStore("comm").get(e);r.onsuccess=function(){var n=r.result;t(void 0!==n?n:"Record ".concat(e," not found"))},r.onerror=function(n){o("Record ".concat(e," not found"))}})}function w(n){var o=document.querySelector(".handle-msg");t.handle=o.value,o.value.length<4||(o.value="",document.querySelector("#commHandle").classList.toggle("pop-show"),e.click())}function L(e){var n=document.querySelector("body"),t=document.createElement("div");H(t,"id","dodexComm"),H(t,"class","dodex-comm"),n.insertBefore(t,document.querySelector(".top--dodex"));var o=t,r=document.createElement("div");H(r,"id","menu"),H(r,"class","menu");var c=document.createElement("p");H(c,"class","welcome"),c.innerHTML='<h1 style="font-size: 14px;">\n    <svg height="18" width="17" style="font-family: \'Open Sans\', sans-serif;">\n    <text x="3" y="18" fill="#059">O</text><text x="0" y="15" fill="#059">D</text></svg> doDex Messaging <span class="handle"></span></h1>',r.appendChild(c),q(c=document.createElement("p")),r.appendChild(c),o.appendChild(r),H(t=document.createElement("div"),"id","chatbox"),H(t,"class","chat-box"),o.appendChild(t);var a=document.createElement("a");H(a,"id","dodexComm"),o.appendChild(a);var d=document.createElement("input");return H(d,"id","inputsend"),H(d,"value","Send"),H(d,"class","input-send"),H(d,"type","button"),o.appendChild(d),H(t=document.createElement("div"),"contenteditable","true"),H(t,"id","usermsg"),H(t,"class","user-msg"),o.appendChild(t),t.addEventListener("keydown",function(e){return!("s"==String.fromCharCode(e.which).toLowerCase()&&e.ctrlKey||19==e.which)||(v(),e.preventDefault(),!1)}),a}function E(){var e=document.querySelector("body"),n=document.createElement("div");H(n,"id","commHandle"),H(n,"class","comm-handle"),e.insertBefore(n,document.querySelector(".top--dodex"));var t=n,o=document.createElement("div");H(o,"id","menuHandle"),H(o,"class","menu");var r=document.createElement("p");H(r,"class","welcome"),r.innerHTML='<h1 class="handle" style="font-size: 14px;">\n            Enter your chat handle</h1>',o.appendChild(r),H(r=document.createElement("p"),"class","close-handle");var c=document.createElement("a");H(c,"id","closeHandle"),c.innerHTML="Exit",c.onclick=function(){document.querySelector("#commHandle").classList.toggle("pop-show")},r.appendChild(c),o.appendChild(r),t.appendChild(o),H(c=document.createElement("a"),"id","handleComm"),t.appendChild(c);var a=document.createElement("br");t.appendChild(a);var d=document.createElement("input");return H(d,"id","inputHandle"),H(d,"value","Save"),H(d,"class","input-save"),H(d,"type","button"),d.onclick=w,t.appendChild(d),H(n=document.createElement("input"),"id","handlemsg"),H(n,"type","text"),H(n,"class","handle-msg"),t.appendChild(n),n.addEventListener("keydown",function(e){return!("s"==String.fromCharCode(e.which).toLowerCase()&&e.ctrlKey||19==e.which)||(w(),e.preventDefault(),!1)}),c}function M(e){var n=document.querySelector("#dodexComm");null!==n.querySelector(".private")&&n.removeChild(n.querySelector(".private"));var t=document.createElement("select");H(t,"class","private"),H(t,"multiple","true");for(var o=e.length,r=0;r<o;r++){var c=document.createElement("option");H(c,"value",e[r].name),c.innerHTML=e[r].name,t.appendChild(c),n.appendChild(t)}t.addEventListener("change",function(e){i=b(e.target)})}function b(e){for(var n,t=[],o=e.options.length,r=0;r<o;r++)(n=e.options[r]).selected&&t.push(n.value);return t}function k(e){for(var n=e.options.length,t=0;t<n;t++)e.options[t].selected=!1}function q(e){var r=document.createElement("img");H(r,"src","../images/more_horiz.png"),H(r,"class","image-horiz");var c=document.createElement("div");H(c,"class","dropdown"),c.appendChild(r);var a=document.createElement("div");H(a,"id","commDropdown"),H(a,"class","dropdown-content");var d=document.createElement("a");H(d,"href","#"),d.innerHTML="Clear Log",a.appendChild(d),H(d=document.createElement("a"),"href","#"),d.innerHTML="Change Handle",a.appendChild(d),H(d=document.createElement("a"),"href","#"),H(d,"name","private"),d.innerHTML="Private Message",a.appendChild(d),H(d=document.createElement("a"),"href","#"),d.innerHTML="Exit",a.appendChild(d),c.appendChild(a),e.appendChild(c),r.onclick=function(){document.querySelector("#commDropdown").classList.toggle("show")},window.onclick=function(e){if(!e.target.matches(".image-horiz")){var n,t=document.querySelectorAll(".dropdown-content");for(n=0;n<t.length;n++){var o=t[n];o.classList.contains("show")&&o.classList.remove("show")}}};for(var l=a.querySelectorAll("a"),m=0;m<l.length;m++)switch(l[m].innerHTML){case"Clear Log":l[m].onclick=function(e){return document.querySelector("#chatbox").innerHTML="",e.preventDefault(),!1};break;case"Change Handle":l[m].onclick=function(e){indexedDB.deleteDatabase("dodex-comm").onsuccess=function(r){document.querySelector(".user-msg").textContent=";removeuser!!",v(),p(e),t.mess.popup(n,t,o)}};break;case"Private Message":case"Broadcast":l[m].onclick=function(e){var n=document.querySelector("#dodexComm").querySelector(".private");return null!==n&&(n.classList.toggle("show"),e.target.innerHTML===u?e.target.innerHTML=s:(e.target.innerHTML=u,i=[],k(document.querySelector("#dodexComm").querySelector("select")))),e.preventDefault(),!1};break;case"Exit":l[m].onclick=p}}function H(e,n,t){var o=document.createAttribute(n);o.value=t,e.setAttributeNode(o)}function T(e){return e<10&&(e="0"+e),e}exports.default=y;var D=[];function P(e,n){var t=n||0,o=D;return[o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]]].join("")}function j(){return Math.random().toString().substr(2,16).toString(10).split("").map(function(e){return parseInt(e)})}function B(e,n,t){var o=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||j)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n)for(var c=0;c<16;++c)n[o+c]=r[c];for(var a=0;a<256;++a)D[a]=(a+256).toString(16).substr(1);return n||P(r)}
},{}]},{},["HAs+"], null)