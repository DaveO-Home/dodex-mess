var parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"HAs+":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var e,n,t,o,r=[128512,128516,127818,127812,127871,127843,127856,127829,127828,127839,128704,128142,128506,9200,128377,128218,128049,128042,128057,128036,128512,128515,128516,128513,128518,128517,129315,128514,128578,128579,128521,128522,128519,129312,128526,129299,129488,127808,127958,127773,128511,9774],c=Math.floor(41*Math.random())+0,a=0,d=null,i=null,l=[],u="Broadcast",s="Private Message";function m(e,n){return(n?/^[\x00-\xFF]*$/:/^[\x00-\x7F]*$/).test(e)}var p=function(e){d||(c=Math.floor(41*Math.random())+0,f.server=t.server,t.mess.getUUID(t.handle+String.fromCodePoint(r[c])).then(function(e){if("string"==typeof e)console.error(e);else{var n=btoa(e.comm.id);t.mess.webSocket({handle:e.comm.handle,id:n}),document.querySelector(".handle").innerHTML=d}}))},h=function(e){f.socket.close(1e3),document.querySelector(".handle").innerHTML="",document.querySelector(".chat-box").innerHTML="",a=0,d=null,i=null,l=[],document.querySelector("#dodexComm").querySelector('a[name="private"]').innerHTML=s},f={popup:function(r,c,a){n=r,o=a,t=c,void 0===e&&((e=M(t)).onclick=p),x("comm").then(function(n){"string"==typeof n?k().click():e.click()})},socket:null,server:"localhost:3087",getUUID:function(e){return C(e)},webSocket:function(e){if(!(e&&e.handle&&e.id))throw new Error("Must supply 'handle' and 'id' for WebSocket");return d=e.handle,i=e.id,this.socket=new WebSocket("ws://"+this.server+"/dodex?handle="+d+"&id="+encodeURIComponent(e.id)),this.socket.onerror=function(e){console.error(e)},this.socket.onopen=function(){document.querySelector(".input-send").onclick=g},this.socket.onmessage=function(e){var n=new Date,t=D(n.getHours()),o=D(n.getMinutes()),r=document.querySelector(".chat-box"),c=v(e.data);r.innerHTML+="".concat(t,":").concat(o," ").concat(c,"<br>"),(r.scrollTop>a||0===a)&&(a=r.scrollTop,r.scrollTop=r.scrollHeight)},this.socket.onclose=function(e){d=null,1e3!==e.code&&console.log("Closed",e.code)},this.socket}};function v(e){var n=e.split("connected:");return n.length<2?e:(b(JSON.parse(n[1])),"connected")}function g(){var e=document.querySelector("#dodexComm").querySelector(".user-msg"),n=e.innerHTML;if(n.length>1){var t=y(n);f.socket.send(t),e.innerHTML=""}}function y(e){return document.querySelector("#dodexComm").querySelector('a[name="private"]').innerHTML===u?e+";users!!"+JSON.stringify(l):e}window.doDexMess=f;var S=f;function x(e){return new Promise(function(e,n){var t=indexedDB.open("dodex-comm");t.onupgradeneeded=function(){t.result.createObjectStore("comm",{keyPath:"idx",autoIncrement:!1})},t.onsuccess=function(n){w("comm",n.target.result).then(function(t){n.target.result.close(),e(t)})},t.onerror=function(e){console.log(e)}})}function C(e){return new Promise(function(n,t){var o,r,c,a=indexedDB.open("dodex-comm");a.onupgradeneeded=function(){o=a.result,c=o.createObjectStore("comm",{keyPath:"idx",autoIncrement:!1})},a.onsuccess=function(t){w("comm",o=t.target.result).then(function(t){if("string"!=typeof t)return o.close(),void n(t);r=o.transaction("comm","readwrite"),c=r.objectStore("comm");var a=O(),d={};d.comm={handle:e,id:a},d.idx="comm",c.put(d).onsuccess=function(e){w("comm",o).then(function(e){o.close(),n(e)})}})},a.onerror=function(e){console.error("Error",e.target)}})}function w(e,n){return new Promise(function(t,o){0===n.objectStoreNames.length&&t("Store ".concat(e," not found"));var r=n.transaction(["comm"],"readonly").objectStore("comm").get(e);r.onsuccess=function(){var n=r.result;t(void 0!==n?n:"Record ".concat(e," not found"))},r.onerror=function(n){o("Record ".concat(e," not found"))}})}function E(n){var o=document.querySelector(".handle-msg");if(t.handle=o.value,!(o.value.length<4)){o.value="";document.querySelector("#closeHandle").click();e.click()}}function M(e){var n=document.querySelector("body"),t=document.createElement("div");T(t,"id","dodexComm"),T(t,"class","dodex-comm"),n.insertBefore(t,document.querySelector(".top--dodex"));var o=t,r=document.createElement("div");T(r,"id","menu"),T(r,"class","menu");var c=document.createElement("p");T(c,"class","welcome"),c.innerHTML='<h1 style="font-size: 14px;">\n    <svg height="18" width="17" style="font-family: \'Open Sans\', sans-serif;">\n    <text x="3" y="18" fill="#059">O</text><text x="0" y="15" fill="#059">D</text></svg> doDex Messaging <span class="handle"></span></h1>',r.appendChild(c),q(c=document.createElement("p")),r.appendChild(c),o.appendChild(r),T(t=document.createElement("div"),"id","chatbox"),T(t,"class","chat-box"),o.appendChild(t);var a=document.createElement("a");T(a,"href","#dodexComm"),T(a,"id","dodexComm"),o.appendChild(a);var d=document.createElement("input");return T(d,"id","inputsend"),T(d,"value","Send"),T(d,"class","input-send"),T(d,"type","button"),o.appendChild(d),T(t=document.createElement("div"),"contenteditable","true"),T(t,"id","usermsg"),T(t,"class","user-msg"),o.appendChild(t),t.addEventListener("keydown",function(e){return!("s"==String.fromCharCode(e.which).toLowerCase()&&e.ctrlKey||19==e.which)||(g(),e.preventDefault(),!1)}),a}function k(){var e=document.querySelector("body"),n=document.createElement("div");T(n,"id","commHandle"),T(n,"class","comm-handle"),e.insertBefore(n,document.querySelector(".top--dodex"));var t=n,o=document.createElement("div");T(o,"id","menuHandle"),T(o,"class","menu");var r=document.createElement("p");T(r,"class","welcome"),r.innerHTML='<h1 class="handle" style="font-size: 14px;">\n            Enter your chat handle</h1>',o.appendChild(r),T(r=document.createElement("p"),"class","close-handle");var c=document.createElement("a");T(c,"id","closeHandle"),T(c,"href","#closeHandle"),c.innerHTML="Exit",r.appendChild(c),o.appendChild(r),t.appendChild(o),T(c=document.createElement("a"),"href","#commHandle"),T(c,"id","handleComm"),t.appendChild(c);var a=document.createElement("br");t.appendChild(a);var d=document.createElement("input");return T(d,"id","inputHandle"),T(d,"value","Save"),T(d,"class","input-save"),T(d,"type","button"),d.onclick=E,t.appendChild(d),T(n=document.createElement("input"),"id","handlemsg"),T(n,"type","text"),T(n,"class","handle-msg"),t.appendChild(n),n.addEventListener("keydown",function(e){return!("s"==String.fromCharCode(e.which).toLowerCase()&&e.ctrlKey||19==e.which)||(E(),e.preventDefault(),!1)}),c}function b(e){var n=document.querySelector("#dodexComm");null!==n.querySelector(".private")&&n.removeChild(n.querySelector(".private"));var t=document.createElement("select");T(t,"class","private"),T(t,"multiple","true");for(var o=e.length,r=0;r<o;r++){var c=document.createElement("option");T(c,"value",e[r].name),c.innerHTML=e[r].name,t.appendChild(c),n.appendChild(t)}t.addEventListener("change",function(e){l=H(e.target)})}function H(e){for(var n,t=[],o=e.options.length,r=0;r<o;r++)(n=e.options[r]).selected&&t.push(n.value);return t}function L(e){for(var n=e.options.length,t=0;t<n;t++)e.options[t].selected=!1}function q(e){var r=document.createElement("img");T(r,"src","../images/more_horiz.png"),T(r,"class","image-horiz");var c=document.createElement("div");T(c,"class","dropdown"),c.appendChild(r);var a=document.createElement("div");T(a,"id","commDropdown"),T(a,"class","dropdown-content");var d=document.createElement("a");T(d,"href","#"),d.innerHTML="Clear Log",a.appendChild(d),T(d=document.createElement("a"),"href","#"),d.innerHTML="Change Handle",a.appendChild(d),T(d=document.createElement("a"),"href","#"),T(d,"name","private"),d.innerHTML="Private Message",a.appendChild(d),T(d=document.createElement("a"),"href","#"),d.innerHTML="Exit",a.appendChild(d),c.appendChild(a),e.appendChild(c),r.onclick=function(){document.querySelector("#commDropdown").classList.toggle("show")},window.onclick=function(e){if(!e.target.matches(".image-horiz")){var n,t=document.querySelectorAll(".dropdown-content");for(n=0;n<t.length;n++){var o=t[n];o.classList.contains("show")&&o.classList.remove("show")}}};for(var i=a.querySelectorAll("a"),m=0;m<i.length;m++)switch(i[m].innerHTML){case"Clear Log":i[m].onclick=function(e){return document.querySelector("#chatbox").innerHTML="",e.preventDefault(),!1};break;case"Change Handle":i[m].onclick=function(e){indexedDB.deleteDatabase("dodex-comm").onsuccess=function(r){document.querySelector(".user-msg").textContent=";removeuser!!",g(),h(e),t.comm.popup(n,t,o)}};break;case"Private Message":case"Broadcast":i[m].onclick=function(e){var n=document.querySelector("#dodexComm").querySelector(".private");return null!==n&&(n.classList.toggle("show"),e.target.innerHTML===s?e.target.innerHTML=u:(e.target.innerHTML=s,l=[],L(document.querySelector("#dodexComm").querySelector("select")))),e.preventDefault(),!1};break;case"Exit":i[m].onclick=h}}function T(e,n,t){var o=document.createAttribute(n);o.value=t,e.setAttributeNode(o)}function D(e){return e<10&&(e="0"+e),e}exports.default=S;var P=[];function j(e,n){var t=n||0,o=P;return[o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],"-",o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]],o[e[t++]]].join("")}function B(){return Math.random().toString().substr(2,16).toString(10).split("").map(function(e){return parseInt(e)})}function O(e,n,t){var o=n&&t||0;"string"==typeof e&&(n="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||B)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n)for(var c=0;c<16;++c)n[o+c]=r[c];for(var a=0;a<256;++a)P[a]=(a+256).toString(16).substr(1);return n||j(r)}
},{}]},{},["HAs+"], null)